I"ı#<h1 id="lsbä¸emdçš„ä¿¡æ¯éšè—ç®—æ³•">LSBä¸EMDçš„ä¿¡æ¯éšè—ç®—æ³•</h1>

<h2 id="ä¸€å®éªŒç¯å¢ƒ">ä¸€ã€å®éªŒç¯å¢ƒ</h2>

<p>1ã€è®¡ç®—æœºä¸€å°ï¼›</p>

<p>2ã€WindowsÂ XPã€windows8/10æ“ä½œç³»ç»Ÿã€C++æˆ–MATLAB7.5Â </p>

<h2 id="äºŒå®éªŒå†…å®¹ä¸ç›®çš„">äºŒã€å®éªŒå†…å®¹ä¸ç›®çš„</h2>

<p>1ã€å­¦ä¹ å¹¶æŒæ¡å›¾åƒä¿¡æ¯éšè—çš„åŸºæœ¬åŸç†å’Œæ–¹æ³•</p>

<p>2ã€å­¦ä¹ ä¸‹é¢åŸºäºLSBçš„ä¿¡æ¯éšè—å’Œæå–ç®—æ³•</p>

<p>3ã€å­¦ä¹ ä¸‹é¢åŸºäºEMDçš„ä¿¡æ¯éšè—å’Œæå–ç®—æ³•</p>

<p>4ã€æŒ‰ç…§ä¸‹é¢æ–°çš„LSBçš„æ›¿æ¢è§„åˆ™å®ç°LSBçš„ä¿¡æ¯éšè—å’Œæå–ç®—æ³•</p>

<p>5ã€è®¾è®¡æ–°çš„EMDä¸­çš„æ¨¡å‡½æ•°å¹¶å®ç°åŸºäºæ–°çš„æ¨¡å‡½æ•°çš„EMDç®—æ³•</p>

<h2 id="ä¸‰å®éªŒåŸç†">ä¸‰ã€å®éªŒåŸç†</h2>

<p>ï¼ˆ1ï¼‰. LSBï¼ˆLeastÂ SignificantÂ Bitï¼‰ç®—æ³•æ˜¯å°†ç§˜å¯†ä¿¡æ¯åµŒå…¥åˆ°è½½ä½“å›¾åƒåƒç´ å€¼çš„æœ€ä½æœ‰æ•ˆä½ï¼Œä¹Ÿç§°æœ€ä¸æ˜¾è‘—ä½ï¼Œæ”¹å˜è¿™ä¸€ä½ç½®å¯¹è½½ä½“å›¾åƒçš„å“è´¨å½±å“æœ€å°ã€‚ç”±äºæ°´å°ä¿¡å·éšè—åœ¨æœ€ä½ä½ï¼Œç›¸å½“äºå åŠ äº†ä¸€ä¸ªèƒ½é‡å¾®å¼±çš„ä¿¡å·ï¼Œå› æ­¤åœ¨è§†è§‰å’Œå¬è§‰ä¸Šå¾ˆéš¾å¯Ÿè§‰ã€‚ä½œä¸ºå¤§æ•°æ®é‡çš„ä¿¡æ¯éšè—æ–¹æ³•ï¼ŒLSBåœ¨éšè—é€šä¿¡ä¸­ä»å æ®ç›¸å½“é‡è¦çš„åœ°ä½ã€‚</p>

<p>LSBç®—æ³•çš„åŸºæœ¬åŸç†ï¼šå¯¹ç©ºåŸŸçš„LSBåšæ›¿æ¢ï¼Œç”¨æ¥æ›¿æ¢LSBçš„åºåˆ—å°±æ˜¯éœ€è¦åŠ å…¥çš„æ°´å°ä¿¡æ¯ï¼ˆå‚è§å›¾1ï¼‰ã€‚ç”±äºæ°´å°ä¿¡æ¯åµŒå…¥çš„ä½ç½®æ˜¯LSBï¼Œä¸ºäº†æ»¡è¶³æ°´å°çš„ä¸å¯è§æ€§ï¼Œå…è®¸åµŒå…¥çš„æ°´å°å¼ºåº¦ä¸å¯èƒ½å¤ªé«˜ã€‚ç„¶è€Œé’ˆå¯¹ç©ºåŸŸçš„å„ç§å¤„ç†ï¼Œå¦‚æ¸¸ç¨‹ç¼–ç å‰çš„é¢„å¤„ç†ï¼Œä¼šå¯¹ä¸æ˜¾è‘—åˆ†é‡è¿›è¡Œä¸€å®šçš„å‹ç¼©ï¼Œæ‰€ä»¥LSBç®—æ³•å¯¹è¿™äº›æ“ä½œå¾ˆæ•æ„Ÿã€‚å› æ­¤LSBç®—æ³•å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§è„†å¼±æ€§æ°´å°ç®—æ³•ã€‚</p>

<p>LSBç®—æ³•ä¸­çš„æ›¿æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p>

<blockquote>
  <p>1---&gt;0:é€šè¿‡-1å¤„ç†</p>
</blockquote>

<blockquote>
  <p>0---&gt;1:é€šè¿‡+1å¤„ç†</p>
</blockquote>

<p>æ–°çš„LSBç®—æ³•ä¸­çš„æ›¿æ¢è§„åˆ™å¦‚ä¸‹ï¼š</p>

<blockquote>
  <p>1 ---&gt;0:é€šè¿‡+1å¤„ç†</p>
</blockquote>

<blockquote>
  <p>0---&gt;1:é€šè¿‡-1å¤„ç†</p>
</blockquote>

<p>æ€è€ƒé¢˜ï¼šäºŒä¸ªè§„åˆ™æœ‰ä½•ä¸åŒï¼Œä¸€èˆ¬æƒ…å†µä¸‹å“ªä¸€ä¸ªè§„åˆ™è¾ƒå¥½ã€‚ç”¨è¿™äºŒä¸ªè§„åˆ™åˆ†åˆ«éšè—ç›¸åŒçš„è—ç§˜ä¿¡æ¯ï¼Œåˆ†åˆ«å¾—åˆ°çš„è—ç§˜å›¾åƒæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹å¯å¦å®ç°LSBç®—æ³•çš„å¯é€†å‘¢ï¼Ÿ</p>

<p><strong>LSBç®—æ³•åŸºæœ¬æ­¥éª¤ï¼š</strong></p>

<p>1ã€å…ˆå°†è½½ä½“å›¾åƒçš„æ¯ä¸€ä¸ªåè¿›åˆ¶åƒç´ å€¼è½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ï¼›å†å°†ç§˜å¯†ä¿¡æ¯ä¹Ÿè½¬æ¢ä¸ºäºŒè¿›åˆ¶æ•°æ®ã€‚</p>

<p>2Â ã€ç”¨äºŒè¿›åˆ¶ç§˜å¯†ä¿¡æ¯ä¸­çš„æ¯ä¸€æ¯”ç‰¹ä¿¡æ¯æ›¿æ¢ä¸ä¹‹ç›¸å¯¹åº”çš„è½½ä½“æ•°æ®çš„æœ€ä½æœ‰æ•ˆä½ï¼›</p>

<ol>
  <li>å°†å«ç§˜å¯†ä¿¡æ¯çš„äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸ºåè¿›åˆ¶åƒç´ å€¼ï¼Œä»è€Œè·å¾—å«ç§˜å¯†ä¿¡æ¯çš„å›¾åƒã€‚</li>
</ol>

<p><img src="https://gitee.com/btbsja/BlogImg/raw/master/blog/2020/03/20200309105449.png" alt="" />{width=â€4.669444444444444inâ€ height=â€2.8inâ€}</p>

<ol>
  <li>ã€ EMDç®—æ³•ä»…é€šè¿‡ä¿®æ”¹nä¸ªåƒç´ ä¸ºä¸€ç»„åƒç´ ä¸­çš„ä¸€ä¸ªåƒç´ çš„ç°åº¦å€¼å°±å¯ä»¥åµŒå…¥ä¸€ä¸ª2n+1è¿›åˆ¶çš„éšç§˜ä¿¡æ¯ï¼Œå…·æœ‰å›¾åƒåƒç´ å€¼æ”¹å˜é‡å°ï¼ŒåµŒå…¥ä¿¡æ¯é‡å¤§çš„ç‰¹ç‚¹ã€‚</li>
</ol>

<p>å®éªŒä¸­æˆ‘ä»¬ä»¥n=2ä¸ºä»£è¡¨è¿›è¡Œå®éªŒï¼Œä¹Ÿå³æ„é€ æ¨¡å‡½æ•°å¦‚ä¸‹ï¼š</p>

<p>åˆ©ç”¨è¿™ä¸ªæ¨¡å‡½æ•°å¯ä»¥æ„é€ 256*256çš„é­”æ–¹çŸ©é˜µã€‚å¤§å®¶ä¹Ÿå¯è€ƒè™‘å…¶ä»–çš„æ¨¡å‡½æ•°ï¼Œå¦‚</p>

<p>å¦‚ä½•åˆ©ç”¨è¿™ä¸ªæ¨¡å‡½æ•°æ„é€ 256*256çš„é­”æ–¹çŸ©é˜µå‘¢ï¼Ÿ</p>

<p>ä¼ ç»Ÿçš„EMDçš„å…·ä½“ç®—æ³•è¯·å‚è§ppt è¯¾ä»¶ã€‚å¤§å®¶æ¯”è¾ƒä¸€ä¸‹ä¼ ç»Ÿçš„EMD ç®—æ³•ä¸LSB matchingç®—æ³•çš„ä¸åŒã€‚</p>

<h2 id="å››å®éªŒæ­¥éª¤">å››ã€<strong>å®éªŒæ­¥éª¤</strong></h2>

<p>åŸºæœ¬çš„LSBç®—æ³•</p>

<p><strong>4.1 LSBç®—æ³•çš„ä¿¡æ¯åµŒå…¥</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Picture=imread(â€˜c:\\test.tifâ€™);                   %è¯»å…¥è½½ä½“å›¾åƒ Double_Picture=Picture;
Double_Picture=double(Double_Picture); %å°†å›¾åƒè½¬æ¢ä¸ºäºŒè¿›åˆ¶
ms_id=fopen(â€˜c:\\test.txtâ€™,'r');           %è¯»å–ç§˜å¯†ä¿¡æ¯æ–‡ä»¶
[msg,len]=fread(â€˜c:\\test.txtâ€™_id,'ubit1');
[m,n]=size(Double_Picture); 
p=1;%p ä¸ºç§˜å¯†ä¿¡æ¯çš„ä½è®¡æ•°å™¨
for  f2=1:n
for  f1=1:m
Double_Picture(f1,f2)=Double_Picture(f1,f2)-mod(Double_Picture(f1,f2),2)+msg(p,1);
%å°†ç§˜å¯†ä¿¡æ¯æŒ‰ä½éšè—å…¥è¿ç»­çš„åƒç´ ä¸­
If  p==len
   break;
end
p=p+1;
end
If  p==len
   break;
end
end
Double_Picture=uint8(Double_Picture);
imwrite(Double_Picture,â€™c:\\result.tifâ€™);  %ç”Ÿæˆç§˜å¯†ä¿¡æ¯
subplot(121);imshow(Picture);title('æœªåµŒå…¥ä¿¡æ¯çš„å›¾ç‰‡');
subplot(122);imshow(Double_Picture);title('åµŒå…¥ä¿¡æ¯çš„å›¾ç‰‡');

</code></pre></div></div>

<p><strong>4.2LSBç®—æ³•çš„ä¿¡æ¯æå–</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Picture=imread(â€˜c:\\result.tifâ€™);%è¯»å…¥éšç§˜ä¿¡æ¯çš„å›¾åƒ
Picture=double(Picture); [m,n]=size(Picture);
frr=fopen(â€˜c:\\result.txtâ€™,'a');
len=8;%è®¾å®šéšç§˜ä¿¡æ¯é•¿åº¦
p=1;
for f2=1:n
for f1=1:m
    if bitand(Picture(f1,f2),1)==1
    %é¡ºåºæå–å›¾åƒç›¸åº”åƒç´ LSB çš„ç§˜å¯†ä¿¡æ¯
        fwrite(frr,1,'bit1');
        result(p,1)=1;
    else
        fwrite(frr,0,'bit1');
        result(p,1)=0;
    end
    if  p==len   %åˆ¤æ–­ç§˜å¯†ä¿¡æ¯æ˜¯å¦è¯»å®Œ
        break;
    end
    p=p+1;
end
if p==len
break;
end
end
fclose(frr);
</code></pre></div></div>

<p><strong>EMD ç®—æ³•çš„åµŒå…¥ä¸æå–ä»£ç ç”±äºæ¯”è¾ƒé•¿ï¼Œè¯·è§ä¸‹é¢é™„å½•</strong></p>

<h2 id="äº”å®éªŒç»“æœå±•ç¤º">äº”ã€å®éªŒç»“æœå±•ç¤º</h2>

<ol>
  <li>LSBæˆ–EMDç®—æ³•åµŒå…¥ä¿¡æ¯å‰åç»“æœå›¾</li>
</ol>

<p><img src="https://gitee.com/btbsja/BlogImg/raw/master/blog/2020/03/20200309105451.png" alt="" />{width=â€1.2694444444444444inâ€ height=â€0.6458333333333334inâ€}</p>

<p>2. ä¿¡å™ªæ¯”ï¼ˆPSNRï¼‰çš„è®¡ç®—</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A=double(Picture);
[m,n]=size(Picture); 
    D=0;
    s=imread(['result.bmp']);
    B=double(s);
    for i=1:256
        for j=1:256
           D=D+(A(i,j)-B(i,j))^2;
        end                                          
    end
    MSE = D / (m*n);
    PSNR=10*log10((255^2)/MSE)
End

</code></pre></div></div>

<p><img src="https://gitee.com/btbsja/BlogImg/raw/master/blog/2020/03/20200309105450.png" alt="" />{width=â€4.707638888888889inâ€ height=â€2.6381944444444443inâ€}</p>

<h2 id="é™„å½•åŸºæœ¬çš„emdç®—æ³•å®ç°">é™„å½•ï¼šåŸºæœ¬çš„EMDç®—æ³•å®ç°</h2>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>function MY2()
clc;clear;
I=imread('coverlena.bmp');
figure;subplot(1,2,1);imshow(I);
title('åŸå›¾');
Secret=10;                           %å¾…éšè—æ•°æ®çš„å¤§å°
data=round(rand(1,Secret));          %éšæœºç”Ÿæˆå¤§å°ä¸ºSecretçš„å¾…éšè—çš„2è¿›åˆ¶æ•°æ®
fprintf('éšè—æ•°æ®ï¼š');disp(data);
[length,width]=size(I);
data3=Num2to5(data,Secret);          %å°†2è¿›åˆ¶æ•°æ®è½¬æ¢ä¸º5è¿›åˆ¶
fprintf('è½¬æ¢æˆ5è¿›åˆ¶ï¼š');disp(data3);
 
KimMatrix=newmatrixn();              %ç”Ÿæˆæ¨¡5çŸ©é˜µ
 
%è¿›è¡Œä¿¡æ¯éšè—
point=1;
for i=1:length
    if point&gt;size(data3,2)
            break;
    end
    for j=1:2:width
        if point&gt;size(data3,2)
            break;
        end
        
        %æ‰¾åˆ°å¯¹åº”ç‚¹å¹¶å¯¹å›¾åƒè¿›è¡Œæ›´æ–°
        if KimMatrix(I(i,j),I(i,j+1))==data3(point)
        elseif KimMatrix(I(i,j)+1,I(i,j+1))==data3(point)
            I(i,j)=I(i,j)+1;
        elseif KimMatrix(I(i,j)-1,I(i,j+1))==data3(point)
            I(i,j)=I(i,j)-1;
        elseif KimMatrix(I(i,j),I(i,j+1)+1)==data3(point)
            I(i,j+1)=I(i,j+1)+1;
        elseif KimMatrix(I(i,j),I(i,j+1)-1)==data3(point)
            I(i,j+1)=I(i,j+1)-1;
        end
        point=point+1;  
    end
end
fprintf('ä¿¡æ¯éšè—æˆåŠŸ!\r\n');
subplot(1,2,2);imshow(I);
title('éšè—åå›¾åƒ');
 
%éšè—ä¿¡æ¯è¯»å–
point=1;
for i=1:length
    if point&gt;size(data3,2)
            break;
    end
    for j=1:2:width
        if point&gt;size(data3,2)
            break;
        end
        
        Data2(point)=KimMatrix(I(i,j),I(i,j+1));
        point=point+1;  
    end
end
Data2=double(Data2);
fprintf('æå–æ•°æ®ï¼š');disp(Data2);
Data=Num5to2(Data2,Secret);         %å°†5è¿›åˆ¶æ•°æ®è½¬æ¢ä¸º2è¿›åˆ¶
fprintf('è½¬æ¢æˆ2è¿›åˆ¶ï¼š');disp(Data);
end
 
function KimMatrix=newmatrixn()     %ç”Ÿæˆæ¨¡5çŸ©é˜µ
n=256;
munit=uint8(zeros(5,5));
for j=1:5
    munit(1,j)=j-1;
    munit(2,j)=mod(j+2,5);
    munit(3,j)=mod(j+5,5);
    munit(4,j)=mod(j+3,5);
    munit(5,j)=mod(j+1,5);
end
nm=ceil(n/5);
nn=ceil(n/5);
KimMatrix=repmat(munit,nm,nn);
KimMatrix=KimMatrix(1:256,1:256);
end
 
function data3=Num2to5(data,Secret)  %å°†2è¿›åˆ¶æ•°æ®è½¬æ¢ä¸º5è¿›åˆ¶
data1=0;
num=1;
for i=Secret:-1:1
    data1=data1+data(i)*num;
    num=num*2;
end
for i=Secret:-1:1
    if data1==0
        break;
    end
    data2(i)=mod(data1,5);
    data1=(data1-mod(data1,5))/5;
end
for i=1:Secret
    if data2(i)~=0
        num=i;
        break;
    end
end
for i=1:Secret-num+1
    data3(i)=data2(num+i-1);
end
end
 
function Data=Num5to2(Data2,Secret)    %å°†5è¿›åˆ¶æ•°æ®è½¬æ¢ä¸º2è¿›åˆ¶
Data1=0;
Data1=double(Data1);
num=1;
for i=size(Data2,2):-1:1
    Data1=Data1+Data2(i)*num;
    num=num*5;
end
Data=zeros(1,Secret);
for i=Secret:-1:1
    if Data1==0
        break;
    end
    Data(i)=mod(Data1,2);
    Data1=(Data1-mod(Data1,2))/2;
end  
end

</code></pre></div></div>

:ET